<!--suppress HtmlDeprecatedAttribute -->
<div align="center">
<picture>
  <source media="(prefers-color-scheme: dark)" srcset=".simbot/logo-dark.svg">
  <source media="(prefers-color-scheme: light)" srcset=".simbot/logo.svg">
  <img alt="simbot logo" src=".simbot/logo.svg" width="260" />
</picture>
<h2>
    ~ Simple Robot ~ <br/> <small>OneBot Component</small>
</h2>
<a href="https://github.com/simple-robot/simbot-component-onebot/releases/latest"><img alt="release" src="https://img.shields.io/github/v/release/simple-robot/simbot-component-onebot" /></a>
<a href="https://repo1.maven.org/maven2/love/forte/simbot/component/simbot-component-onebot11-core/" target="_blank">
  <img alt="release" src="https://img.shields.io/maven-central/v/love.forte.simbot.component/simbot-component-onebot11-core" /></a>
   <hr>
<p>
   <img alt="stars" src="https://img.shields.io/github/stars/simple-robot/simbot-component-onebot" />
   <img alt="forks" src="https://img.shields.io/github/forks/simple-robot/simbot-component-onebot" />
   <img alt="watchers" src="https://img.shields.io/github/watchers/simple-robot/simbot-component-onebot" />
   <img alt="repo size" src="https://img.shields.io/github/repo-size/simple-robot/simbot-component-onebot" />
   <img alt="issues" src="https://img.shields.io/github/issues-closed/simple-robot/simbot-component-onebot?color=green" />
   <img alt="last commit" src="https://img.shields.io/github/last-commit/simple-robot/simbot-component-onebot" />
   <a href="./COPYING"><img alt="copying" src="https://img.shields.io/github/license/simple-robot/simbot-component-onebot" /></a>
</p>
<p>
<img src="https://img.shields.io/badge/OneBot-11-black?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAABwCAMAAADxPgR5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAxQTFRF////29vbr6+vAAAAk1hCcwAAAAR0Uk5T////AEAqqfQAAAKcSURBVHja7NrbctswDATQXfD//zlpO7FlmwAWIOnOtNaTM5JwDMa8E+PNFz7g3waJ24fviyDPgfhz8fHP39cBcBL9KoJbQUxjA2iYqHL3FAnvzhL4GtVNUcoSZe6eSHizBcK5LL7dBr2AUZlev1ARRHCljzRALIEog6H3U6bCIyqIZdAT0eBuJYaGiJaHSjmkYIZd+qSGWAQnIaz2OArVnX6vrItQvbhZJtVGB5qX9wKqCMkb9W7aexfCO/rwQRBzsDIsYx4AOz0nhAtWu7bqkEQBO0Pr+Ftjt5fFCUEbm0Sbgdu8WSgJ5NgH2iu46R/o1UcBXJsFusWF/QUaz3RwJMEgngfaGGdSxJkE/Yg4lOBryBiMwvAhZrVMUUvwqU7F05b5WLaUIN4M4hRocQQRnEedgsn7TZB3UCpRrIJwQfqvGwsg18EnI2uSVNC8t+0QmMXogvbPg/xk+Mnw/6kW/rraUlvqgmFreAA09xW5t0AFlHrQZ3CsgvZm0FbHNKyBmheBKIF2cCA8A600aHPmFtRB1XvMsJAiza7LpPog0UJwccKdzw8rdf8MyN2ePYF896LC5hTzdZqxb6VNXInaupARLDNBWgI8spq4T0Qb5H4vWfPmHo8OyB1ito+AysNNz0oglj1U955sjUN9d41LnrX2D/u7eRwxyOaOpfyevCWbTgDEoilsOnu7zsKhjRCsnD/QzhdkYLBLXjiK4f3UWmcx2M7PO21CKVTH84638NTplt6JIQH0ZwCNuiWAfvuLhdrcOYPVO9eW3A67l7hZtgaY9GZo9AFc6cryjoeFBIWeU+npnk/nLE0OxCHL1eQsc1IciehjpJv5mqCsjeopaH6r15/MrxNnVhu7tmcslay2gO2Z1QfcfX0JMACG41/u0RrI9QAAAABJRU5ErkJggg==" />
</p>
</div>

Simple Robot OneBot ç»„ä»¶æ˜¯ä¸€ä¸ªå°†
[OneBot11](https://github.com/botuniverse/onebot-11)
åè®®åœ¨
[Simple Robot](http://github.com/simple-robot/simpler-robot) æ ‡å‡†APIä¸‹å®ç°çš„ç»„ä»¶åº“ï¼Œ
å¹¶ç”±æ­¤æä¾›simbotä¸­çš„å„é¡¹èƒ½åŠ›ã€‚

å®ƒæ˜¯ä¸€ä¸ª Kotlin multiplatform åº“ï¼ŒJava å‹å¥½ã€å¼‚æ­¥é«˜æ•ˆï¼

å€ŸåŠ©simbotæ ¸å¿ƒåº“æä¾›çš„èƒ½åŠ›ï¼Œå®ƒå¯ä»¥æ”¯æŒå¾ˆå¤šé«˜çº§åŠŸèƒ½å’Œå°è£…ï¼Œæ¯”å¦‚ç»„ä»¶ååŒã€Springæ”¯æŒç­‰ï¼Œ
ç¥ä½ å¿«é€Ÿå¼€å‘ OneBot å®¢æˆ·ç«¯åº”ç”¨ï¼

åºåˆ—åŒ–å’Œç½‘ç»œè¯·æ±‚ç›¸å…³åˆ†åˆ«åŸºäº [Kotlin serialization](https://github.com/Kotlin/kotlinx.serialization)
å’Œ [Ktor](https://ktor.io/)ã€‚

## æ–‡æ¡£ä¸å¼•å¯¼

- OneBotç»„ä»¶æ‰‹å†Œ(ğŸš§å»ºè®¾ä¸­): [OneBotç»„ä»¶æ‰‹å†Œ](https://simple-robot.github.io/simbot-component-onebot/)
- äº†è§£simbot: [Simple Robot åº”ç”¨æ‰‹å†Œ](https://simbot.forte.love)
- [æ–‡æ¡£å¼•å¯¼ç«™&APIæ–‡æ¡£](https://docs.simbot.forte.love)
- [**ç¤¾ç¾¤**](https://simbot.forte.love/communities.html) æ–‡æ¡£ä¸­ä¹Ÿæœ‰æä¾›ç¤¾ç¾¤ä¿¡æ¯å–”
- å‰å¾€ [ç»„ç»‡é¦–é¡µ](https://github.com/simple-robot/) äº†è§£æ›´å¤šæœ‰å…³ç»„ä»¶ã€æ–‡æ¡£ã€ä»¥åŠç¤¾ç¾¤ç­‰ç›¸å…³ä¿¡æ¯ï¼

---

æˆ‘ä»¬æ¬¢è¿å¹¶æœŸæœ›ç€æ‚¨çš„
[åé¦ˆ](https://github.com/simple-robot/simbot-component-onebot/issues)
æˆ–
[ååŠ©](https://github.com/simple-robot/simbot-component-onebot/pulls)ï¼Œ
æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ä¸æ”¯æŒï¼

## å¿«é€Ÿå¼€å§‹

> [!warning]
> æ‰‹å†Œæ–½å·¥å®Œæˆä¹‹å‰ï¼Œæ­¤å¤„ä¸´æ—¶æä¾›å¿«é€Ÿå¼€å§‹ã€‚æ‰‹å†Œæ–½å·¥å®Œæˆåä¼šåˆ é™¤ã€‚

> [!note]
> æ ¸å¿ƒåº“çš„ç‰ˆæœ¬å¯å‰å¾€ 
> [æ­¤å¤„](https://github.com/simple-robot/simpler-robot/releases) 
> å‚è€ƒã€‚

### Ktor å®¢æˆ·ç«¯å¼•æ“

é¦–å…ˆï¼ŒOneBotç»„ä»¶ä½¿ç”¨ [Ktor](https://ktor.io/)
ä½œä¸ºHTTPå®¢æˆ·ç«¯ä¸WSå®¢æˆ·ç«¯ï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ä¾èµ–ä¸­ä¸ä¼šæœ‰ä»»ä½•å…·ä½“çš„å¼•æ“å®ç°ã€‚

å› æ­¤ä½ éœ€è¦æ ¹æ®ä½ çš„ä½¿ç”¨å¹³å°å‰å¾€ [Ktor client Engines](https://ktor.io/docs/client-engines.html#limitations)
é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å¼•æ“ä½¿ç”¨ã€‚

> [!tip]
> æ³¨æ„ï¼Œä½ éœ€è¦é€‰æ‹©ä¸€ä¸ªæ”¯æŒHTTPå’ŒWebSocketçš„å¼•æ“ã€‚
> é™¤éä½ æ‰“ç®—é€šè¿‡æ›´è¯¦ç»†çš„é…ç½®ä¸ºä¸¤ä¸ªåœºæ™¯åˆ†é…ä¸åŒçš„å¼•æ“å®ç°ã€‚

ä»¥ Java11+ çš„æƒ…å†µä¸ºä¾‹ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ `Java` å¼•æ“ï¼š

Gradle:

```kotlin
runtimeOnly("io.ktor:ktor-client-java:$KTOR_VERSION")
```

Maven:

```xml
<dependency>
    <groupId>io.ktor</groupId>
    <artifactId>ktor-client-java-jvm</artifactId>
    <version>${KTOR_VERSION}</version>
    <scope>runtime</scope>
</dependency>
```

### æ™®é€šæ ¸å¿ƒåº“

Gradle:

```kotlin
// æŒ‡å®šæ ¸å¿ƒåº“ä¾èµ–
implementation("love.forte.simbot:simbot-core:$SIMBOT_VERSION")
// å¼•å…¥OneBotç»„ä»¶åº“
implementation("love.forte.simbot.component:simbot-component-onebot-v11-core:$VERSION")
```

Maven:

```xml
<dependencies>
    <!-- æŒ‡å®šæ ¸å¿ƒåº“ä¾èµ– -->
    <dependency>
        <groupId>love.forte.simbot</groupId>
        <artifactId>simbot-core-jvm</artifactId>
        <version>${SIMBOT_VERSION}</version>
    </dependency>
    <dependency>
        <groupId>love.forte.simbot.component</groupId>
        <artifactId>simbot-component-onebot-v11-core-jvm</artifactId>
        <version>${VERSION}</version>
    </dependency>
</dependencies>
```

```kotlin
suspend fun main() {
    val app = launchSimpleApplication {
        // ä½¿ç”¨OneBot11åè®®ç»„ä»¶
        useOneBot11()
    }

    // æ³¨å†Œã€ç›‘å¬äº‹ä»¶
    app.listeners {
        // ä¾‹å¦‚ï¼šç›‘å¬OneBotçš„æ™®é€šç¾¤æ¶ˆæ¯
        process<OneBotNormalGroupMessageEvent> { event ->
            println("event: $event")
            if (event.messageContent.plainText?.trim() == "ä½ å¥½") {
                event.reply("ä½ ä¹Ÿå¥½")
            }
        }
    }

    // æ³¨å†ŒBot
    // å…ˆå¾—åˆ°OneBotçš„BotManager
    app.oneBot11Bots {
        val bot = register(OneBotBotConfiguration().apply {
            botUniqueId = "123456"
            apiServerHost = Url("http://localhost:3000")
            eventServerHost = Url("ws://localhost:3001")
        })

        // å¯åŠ¨bot
        bot.start()
    }

    // æŒ‚èµ·ç›´åˆ°è¢«ç»ˆæ­¢
    app.join()
}
```

### é…åˆ Spring Boot

Gradle:

```kotlin
// ä½ çš„å…¶ä»–SpringBootä¾èµ–..

// æŒ‡å®šæ ¸å¿ƒåº“ä¾èµ–
implementation("love.forte.simbot:simbot-core-spring-boot-starter:$SIMBOT_VERSION")
// å¼•å…¥OneBotç»„ä»¶åº“
implementation("love.forte.simbot.component:simbot-component-onebot-v11-core:$VERSION")
```

Maven:

```xml
<dependencies>
    <!-- ä½ çš„å…¶ä»–SpringBootä¾èµ–.. -->
    
    
    <!-- æŒ‡å®šæ ¸å¿ƒåº“ä¾èµ– -->
    <dependency>
        <groupId>love.forte.simbot</groupId>
        <artifactId>simbot-core-spring-boot-starter</artifactId>
        <version>${SIMBOT_VERSION}</version>
    </dependency>
    <dependency>
        <groupId>love.forte.simbot.component</groupId>
        <artifactId>simbot-component-onebot-v11-core-jvm</artifactId>
        <version>${VERSION}</version>
    </dependency>
</dependencies>
```


Kotlin:

```Kotlin
@SpringBootApplication
@EnableSimbot
class MyApp

fun main(vararg args: String) {
    runApplication<MyApp>(*args)
}

@Component
class MyHandlers {

    /**
     * ä¾‹å¦‚ï¼šç›‘å¬OneBotçš„æ™®é€šç¾¤æ¶ˆæ¯
     */
    @Listener
    @Filter("ä½ å¥½")
    @ContentTrim
    suspend fun onGroupMessage(event: OneBotNormalGroupMessageEvent) {
        event.reply("ä½ ä¹Ÿå¥½")
    }
}
```

or Java:

```java
@SpringBootApplication
@EnableSimbot
public class MyApp {
    public static void main(String[] args) {
        SpringApplication.run(MyApp.class, args);
    }

    @Component
    public static class MyHandlers {

        /**
         * ä¾‹å¦‚ï¼šç›‘å¬OneBotçš„æ™®é€šç¾¤æ¶ˆæ¯
         */
        @Listener
        @Filter("ä½ å¥½")
        @ContentTrim
        public CompletableFuture<?> onGroupMessage(OneBotNormalGroupMessageEvent event) {
            return event.replyAsync("ä½ ä¹Ÿå¥½");
        }
    }
}
```

#### é…ç½®æ–‡ä»¶

ä½¿ç”¨springçš„æ—¶å€™ç”¨çš„ã€‚éœ€è¦æ³¨æ„å®é™…ä¸Šæ˜¯ä¸å…è®¸ä½¿ç”¨æ³¨é‡Šçš„ï¼Œè¿™é‡Œåªæ˜¯æ–¹ä¾¿å±•ç¤ºã€‚

é…ç½®æ–‡ä»¶æ”¾åœ¨èµ„æºç›®å½• `resources` ä¸­çš„ `/simbot-bots/` ç›®å½•ä¸‹ï¼Œä»¥ `.bot.json` æ ¼å¼ç»“å°¾ï¼Œ
ä¾‹å¦‚ `myBot.bot.json`ã€‚

```json5
{
  // å›ºå®šå€¼
  "component": "simbot.onebot11",
  "authorization": {
    // å”¯ä¸€IDï¼Œä½œä¸ºç»„ä»¶å†… Bot çš„ idï¼Œç”¨äºç»„ä»¶å†…å»é‡ã€‚å¯ä»¥éšä¾¿ç¼–ï¼Œä½†å»ºè®®æ˜¯botçš„qqå·
    "botUniqueId": "123456",
    // apiåœ°å€ï¼Œæ˜¯ä¸ªhttp/httpsæœåŠ¡å™¨çš„è·¯å¾„ï¼Œé»˜è®¤localhost:3000
    "apiServerHost": "http://localhost:3000",
    // è®¢é˜…äº‹ä»¶çš„æœåŠ¡å™¨åœ°å€ï¼Œæ˜¯ä¸ªws/wssè·¯å¾„ï¼Œé»˜è®¤localhost:3001
    "eventServerHost":"ws://localhost:3001",
    // é…ç½®çš„ tokenï¼Œå¯ä»¥æ˜¯null
    "accessToken": null 
  },
  // é¢å¤–çš„å¯é€‰é…ç½®
  // configæœ¬èº«ä»¥åŠå…¶å†…çš„å„é¡¹å±æ€§ç»å¤§å¤šæ•°éƒ½å¯çœç•¥æˆ–null
  "config": { 
    // APIè¯·æ±‚ä¸­çš„è¶…æ—¶è¯·æ±‚é…ç½®ã€‚æ•´æ•°æ•°å­—ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸º `null`ã€‚
    "apiHttpRequestTimeoutMillis": null,
    // APIè¯·æ±‚ä¸­çš„è¶…æ—¶è¯·æ±‚é…ç½®ã€‚æ•´æ•°æ•°å­—ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸º `null`ã€‚
    "apiHttpConnectTimeoutMillis": null,
    // APIè¯·æ±‚ä¸­çš„è¶…æ—¶è¯·æ±‚é…ç½®ã€‚æ•´æ•°æ•°å­—ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸º `null`ã€‚
    "apiHttpSocketTimeoutMillis": null,
    // æ¯æ¬¡å°è¯•è¿æ¥åˆ° ws æœåŠ¡æ—¶çš„æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œå¤§äºç­‰äº0çš„æ•´æ•°ï¼Œé»˜è®¤ä¸º 2147483647
    "wsConnectMaxRetryTimes": null,
    // æ¯æ¬¡å°è¯•è¿æ¥åˆ° ws æœåŠ¡æ—¶ï¼Œå¦‚æœéœ€è¦é‡æ–°å°è¯•ï¼Œåˆ™æ¯æ¬¡å°è¯•ä¹‹é—´çš„ç­‰å¾…æ—¶é•¿
    // æ•´æ•°æ•°å­—ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸º 3500
    "wsConnectRetryDelayMillis": null,
  }
}
```

## äº‹ä»¶ç›‘å¬

ç®€å•åˆ—ä¸¾ä¸€ä¸‹åŸå§‹äº‹ä»¶ä¸å¯èƒ½å¯¹åº”çš„ç»„ä»¶äº‹ä»¶ä¹‹é—´çš„å…³ç³»ã€‚

| åŸå§‹äº‹ä»¶                                          | ç»„ä»¶äº‹ä»¶                                   |
|-----------------------------------------------|----------------------------------------|
| `MetaEvent`                                   | `OneBotMetaEvent`                      |
| > `LifecycleEvent`                            | > `OneBotLifecycleEvent`               |
| > `HeartbeatEvent`                            | > `OneBotHeartbeatEvent`               |
| `MessageEvent`                                | `OneBotMessageEvent`                   |
| > `GroupMessageEvent`                         | > `OneBotGroupMessageEvent`            |
| > `GroupMessageEvent`                         | > > `OneBotNormalGroupMessageEvent`    |
| > `GroupMessageEvent`                         | > > `OneBotAnonymousGroupMessageEvent` |
| > `GroupMessageEvent`                         | > > `OneBotNoticeGroupMessageEvent`    |
| > `PrivateMessageEvent`                       | > `OneBotPrivateMessageEvent`          |
| > `PrivateMessageEvent`                       | > > `OneBotFriendMessageEvent`         |
| > `PrivateMessageEvent`                       | > > `OneBotGroupPrivateMessageEvent`   |
| `RequestEvent`                                | `OneBotRequestEvent`                   |
| > `FriendRequestEvent`                        | > `OneBotFriendRequestEvent`           |
| > `GroupRequestEvent`                         | > `OneBotGroupRequestEvent`            |
| `NoticeEvent`                                 | `OneBotNoticeEvent`                    |
| > `FriendAddEvent`                            | > `OneBotFriendAddEvent`               |
| > `FriendRecallEvent`                         | > `OneBotFriendRecallEvent`            |
| > `GroupAdminEvent`                           | > `OneBotGroupAdminEvent`              |
| > `GroupBanEvent`                             | > `OneBotGroupBanEvent`                |
| > `GroupIncreaseEvent` æˆ– `GroupDecreaseEvent` | > `OneBotGroupChangeEvent`             |
| > `GroupIncreaseEvent`                        | > > `OneBotGroupMemberIncreaseEvent`   |
| > `GroupDecreaseEvent`                        | > > `OneBotGroupMemberDecreaseEvent`   |
| > `GroupRecallEvent`                          | > `OneBotGroupRecallEvent`             |
| > `GroupUploadEvent`                          | > `OneBotGroupUploadEvent`             |
| > `NotifyEvent`                               | > `OneBotNotifyEvent`                  |
| > `NotifyEvent`                               | > > `OneBotHonorEvent`                 |
| > `NotifyEvent`                               | > > `OneBotLuckyKingEvent`             |
| > `NotifyEvent`                               | > > `OneBotPokeEvent`                  |
| > `NotifyEvent`                               | > > > `OneBotMemberPokeEvent`          |
| > `NotifyEvent`                               | > > > `OneBotBotSelfPokeEvent`         |
| `UnknownEvent`                                | > `UnknownEvent`                       |
| æ—                                              | `OneBotBotStageEvent`                  |
| æ—                                              | > `OneBotBotRegisteredEvent`           |
| æ—                                              | > `OneBotBotStartedEvent`              |
| ä»»æ„æœªæ”¯æŒäº‹ä»¶                                       | `OneBotUnsupportedEvent`               |

å…¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ `OneBotUnsupportedEvent` å’Œ `OneBotUnknownEvent`
æ¥é—´æ¥åœ°ç›‘å¬é‚£äº›å°šæœªæä¾›ç»„ä»¶äº‹ä»¶ç±»å‹çš„åŸå§‹äº‹ä»¶ã€‚

> [!note]
> OB11åè®®ä¸­çš„äº‹ä»¶ç±»å‹å‡æœ‰å®ç°ã€‚

## License

```
This program is free software: you can redistribute it and/or 
modify it under the terms of the GNU Lesser General 
Public License as published by the Free Software Foundation, 
either version 3 of the License, or (at your option) 
any later version.

This program is distributed in the hope that it will be useful, 
but WITHOUT ANY WARRANTY; without even the implied 
warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
See the GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public 
License along with this program. 
If not, see <https://www.gnu.org/licenses/>.
```
